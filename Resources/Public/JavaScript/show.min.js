(function(){function v(){var b=f.value,a=new FormData;a.append("searchText",b);a.append("partnerLabelFields",n);fetch("/",{method:"POST",body:a}).then(function(e){return e.json()}).then(function(e){if(c&&(0<e.length||!w)){for(var p=parseInt(c.value,10);1<c.options.length;)c.remove(1);var k=!1;e.forEach(function(q){q.uid===p&&(k=q.selected=!0);y(q)});k||(c.options[0].selected=!0)}r();l()})["catch"](function(e){console.error("Error:",e)})}function y(b){var a=document.createElement("option");a.value=b.uid;a.textContent="";n.split(",").forEach(function(e,p,k){a.textContent+=b[e];Object.is(k.length-1,p)||(a.textContent+=" "+x+" ")});a.selected=b.selected;c.appendChild(a)}function r(){g.disabled=!0;g.required=!1;d.forEach(function(b){"-1"===b.value&&b.checked&&(g.disabled=!1,g.required=!0)})}function t(){var b;h.forEach(function(a){a.checked&&(b=parseInt(a.value,10))});d.forEach(function(a){a.required=!0;if(a.checked&&0===parseInt(a.value,10)){var e=a.getAttribute("data-validation");a.setCustomValidity(e)}else a.setCustomValidity("")});0!==u&&b>u?d.forEach(function(a){a.required=!0}):d.forEach(function(a){a.required=!1;a.setCustomValidity("")})}function z(b){b.target.checkValidity()||b.preventDefault();var a=parseInt(c.value,10);isNaN(a)||0===a?(a=c.getAttribute("data-validation"),c.setCustomValidity(a),b.preventDefault()):c.setCustomValidity("")}function l(){var b=parseInt(c.value,10),a=parseInt(document.querySelector('input[name="tx_partnerrating_pi1[reason]"]:checked').value,10);0===b&&0!==a?(b=c.getAttribute("data-validation"),c.setCustomValidity(b)):c.setCustomValidity("")}function A(){var b=window.location.href,a=b.indexOf("/saved/");-1!==a&&(b=b.substring(0,a),history.replaceState(null,"",b))}function B(){setTimeout(function(){m.classList.remove("show");m.classList.add("d-none");f.focus()},3E3)}var f,c,g,d,h,m,u=0,w=!1,n="",x="";document.addEventListener("DOMContentLoaded",function(){var b=document.querySelector(".tx_partnerrating");b?(d=b.querySelectorAll('input[name="tx_partnerrating_pi1[reason]"]'),g=b.querySelector('textarea[name="tx_partnerrating_pi1[reasonText]"]'),f=b.querySelector('input[name="tx_partnerrating_pi1[partnerSearch]"]'),c=b.querySelector('select[name="tx_partnerrating_pi1[partner]"]'),h=b.querySelectorAll('input[name="tx_partnerrating_pi1[rating]"]'),m=b.querySelector(".saved-rating-alert"),b=b.querySelector("form"),b.hasAttribute("data-rating-reason-min-value")&&(u=parseInt(b.getAttribute("data-rating-reason-min-value"),10)),b.hasAttribute("data-keep-min-one-search-result")&&(w="1"===b.getAttribute("data-keep-min-one-search-result")),b.hasAttribute("data-partner-label-fields")&&(n=b.getAttribute("data-partner-label-fields")),b.hasAttribute("data-partner-label-field-split-string")&&(x=b.getAttribute("data-partner-label-field-split-string")),f&&c&&(f.addEventListener("input",v),v(),f.focus()),d&&g&&(d.forEach(function(a){a.addEventListener("change",r)}),r()),h&&d&&(d.forEach(function(a){a.addEventListener("change",t)}),h.forEach(function(a){a.addEventListener("change",t)}),t()),h&&d&&c&&d.forEach(function(a){a.addEventListener("change",l)}),c&&(c.addEventListener("change",l),l()),b&&b.addEventListener("submit",z),f&&m&&B(),A()):console.error("DOM elements not found.")})})();