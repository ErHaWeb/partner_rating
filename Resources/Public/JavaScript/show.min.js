(function(){function y(){var a=h.value,b=new FormData;b.append("searchText",a);b.append("partnerLabelFields",t);fetch("/",{method:"POST",body:b}).then(function(f){return f.json()}).then(function(f){if(c&&(0<f.length||!z)){for(var k=parseInt(c.value,10);1<c.options.length;)c.remove(1);var q=!1;f.forEach(function(u){u.uid===k&&(q=u.selected=!0);D(u)});q||(c.options[0].selected=!0)}})["catch"](function(f){console.error("Error:",f)})}function D(a){var b=document.createElement("option");b.value=a.uid;b.textContent="";t.split(",").forEach(function(f,k,q){b.textContent+=a[f];Object.is(q.length-1,k)||(b.textContent+=" "+A+" ")});b.selected=a.selected;c.appendChild(b)}function B(){g.disabled=!0;g.required=!1;e.forEach(function(a){"-1"===a.value&&a.checked&&(g.disabled=!1,g.required=!0)})}function v(){l.forEach(function(a){a.checked&&(w=parseInt(a.value,10))});e.forEach(function(a){m||(a.required=!0);if(a.checked&&0===parseInt(a.value,10)){var b=n.getAttribute("data-validation");a.setCustomValidity(b)}else a.setCustomValidity("")});m||(0!==p&&w>p?e.forEach(function(a){a.required=!0}):e.forEach(function(a){a.required=!1;a.setCustomValidity("")}))}function E(a){a.target.checkValidity()||a.preventDefault();c.setCustomValidity("");var b=parseInt(c.value,10);if(isNaN(b)||0===b)b=c.getAttribute("data-validation"),c.setCustomValidity(b),a.preventDefault(),d.reportValidity();C(a)}function C(a){var b=!1;e.forEach(function(k){k.checked&&(b=!0)});e.forEach(function(k){k.setCustomValidity("")});if(0!==p&&w>p&&!b&&""===g.value){var f=n.getAttribute("data-validation");e[0].setCustomValidity(f);a.preventDefault();d.reportValidity()}}function x(){var a=parseInt(c.value,10),b=document.querySelector('[name="tx_partnerrating_pi1[rating][reason]"]:checked');null!==b&&parseInt(b.value,10);0===a?(a=c.getAttribute("data-validation"),c.setCustomValidity(a)):c.setCustomValidity("")}function F(){setTimeout(function(){r.classList.remove("show");r.classList.add("d-none");h.focus()},3E3)}var d=null,h=null,c=null,g=null,n=null,e=null,l=null,r=null,w=0,p=0,z=!1,t="",A="",m=!1;document.addEventListener("DOMContentLoaded",function(){var a=document.querySelector(".tx_partnerrating");a?(d=a.querySelector("form"),d.hasAttribute("data-ratingreasonminvalue")&&(p=parseInt(d.getAttribute("data-ratingreasonminvalue"),10)),d.hasAttribute("data-keepminonesearchresult")&&(z="1"===d.getAttribute("data-keepminonesearchresult")),d.hasAttribute("data-partnerlabelfields")&&(t=d.getAttribute("data-partnerlabelfields")),d.hasAttribute("data-partnerlabelfieldsplitstring")&&(A=d.getAttribute("data-partnerlabelfieldsplitstring")),d.hasAttribute("data-allowmultiplereasons")&&(m="1"===d.getAttribute("data-allowmultiplereasons")),n=a.querySelector(".wrapper-reason"),h=a.querySelector('[name="tx_partnerrating_pi1[partnerSearch]"]'),c=a.querySelector('[name="tx_partnerrating_pi1[rating][partner]"]'),l=a.querySelectorAll('[name="tx_partnerrating_pi1[rating][rateValue]"]'),g=a.querySelector('[name="tx_partnerrating_pi1[rating][reasonText]"]'),r=a.querySelector(".saved-rating-alert"),e=m?n.querySelectorAll('[name="tx_partnerrating_pi1[rating][reason][]"]'):n.querySelectorAll('[name="tx_partnerrating_pi1[rating][reason]"]'),h&&c&&(h.addEventListener("input",y),y(),h.focus()),g&&g.addEventListener("input",C),e&&g&&!m&&(e.forEach(function(b){b.addEventListener("change",B)}),B()),l&&e&&(e.forEach(function(b){b.addEventListener("change",v)}),l.forEach(function(b){b.addEventListener("change",v)}),v()),l&&e&&c&&e.forEach(function(b){b.addEventListener("change",x)}),c&&(c.addEventListener("change",x),x()),d&&d.addEventListener("submit",E),h&&r&&F()):console.error("DOM elements not found.")})})();